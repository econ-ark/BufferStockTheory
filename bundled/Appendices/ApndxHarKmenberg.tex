% -*- mode: LaTeX; TeX-PDF-mode: t; -*-
\input{./.econtexRoot}\documentclass[\econtexRoot/BufferStockTheory]{subfiles}
\input{./.econtexRoot}\input{\LaTeXInputs/econtex_onlyinsubfile} 

\onlyinsubfile{\externaldocument{\LaTeXGenerated/BufferStockTheory}} % Get xrefs -- esp to appendix -- from main file; only works properly if main file has already been compiled;
\begin{document}

\begin{comment}
Consider any configuration of parameter values under which, with the variance of permanent shocks equal to zero, the {\GICRaw} holds exactly:
\begin{align}
  \GICRaw & = 1 = \exp\left(\tilde{\Ex}[\log \permShk]\right)
\end{align}
\end{comment}

\section{Harmenberg's Method}\label{sec:ApndxHarKmenberg}

\newcommand{\permLvlPrb}{p}
\newcommand{\permLvlVec}{\mathrm{p}}
\newcommand{\lomdkPrb}{\pi} 
\newcommand{\lomdkPrbmm}{\varpi} 
\newcommand{\lomdkMat}{\Pi}
\newcommand{\Prb}{f}
%\newcommand{\Vct}{\mathrm{F}}
\newcommand{\Vct}{\digamma}
\newcommand{\permShkPrb}{\Prb_{\permShk}}
\newcommand{\permShkVec}{\Vct_{\permShk}}
\newcommand{\permShkRawPrb}{\Prb_{\permShk}}
\newcommand{\permShkRawVec}{\Vct_{\permShk}}
\newcommand{\permShkWgtPrb}{\tilde{\Prb}_{\permShk}}
\newcommand{\permShkWgtVec}{\tilde{\Vct}_{\permShk}}
\newcommand{\mpPrb}{\chi}
\newcommand{\mpPrbMarg}{\mpPrb^{\mNrm}}
\newcommand{\Wgt}{\tilde}
\newcommand{\Raw}{}
\newcommand{\mpPrbMargRaw}{\Raw{\mpPrb}^{\mNrm}}
\newcommand{\mpPrbMargWgt}{\Wgt{\mpPrb}^{\mNrm}}
\newcommand{\mpMat}{\mathrm{X}}
\newcommand{\mpMatMarg}{\mpMat^{\mNrm}}
\newcommand{\mpMatMargRaw}{\Raw{\mpMat}^{\mNrm}}
\newcommand{\mpMatMargWgt}{\Wgt{\mpMat}^{\mNrm}}
\newcommand{\mNrmVec}{\mathrm{m}}
\newcommand{\mNrmNow}{\mNrm_{t}}
\newcommand{\mNrmNxt}{\mNrm_{t+1}}
\newcommand{\Bot}{\ushort}
\newcommand{\mNrmNxtBot}{\Bot{\mNrm}_{t+1}}
\newcommand{\permShkNow}{\permShk_{t}}
\newcommand{\permShkPrbNxt}{\permShk_{t+1}}
\newcommand{\permShkPrbBot}{\Bot{\permShk}}
\newcommand{\permShkPrbNxtBot}{\Bot{\permShk}_{t+1}}
\newcommand{\permLvlPrbNxt}{\permLvlPrb_{t+1}}
\newcommand{\permLvlPrbNxtBot}{\Bot{\permLvlPrb}_{t+1}}
\newcommand{\permLvlPrbNow}{\permLvlPrb_{t}}
\newcommand{\tranShkNow}{\tranShk_{t}}
\newcommand{\tranShkNxt}{\tranShk_{t+1}}
\newcommand{\mLvlNow}{\mLvl_{t}}
\newcommand{\mLvlNxt}{\mLvl_{t+1}}

Harmenberg defines a `density kernel' describing the law of motion for the normalized state $\lomdkPrb(\mNrmNxt,\mNrmNow,\permShkPrbNxt)$ and defines $\permShkRawPrb$ as the density of the permanent shock distribution; we correspondingly define $F_{\permShk}$ as the CDF of permanent shocks.

The joint cumulative distribution boldface $\pmb{\mpPrb}$ for $\mNrmNxt$ and $\permLvlPrbNxt$ as a function of the stochastic variables and the joint marginal distributions (nonbold $\mpPrb$) in period $t$ is:
\begin{equation}
  \begin{aligned} \label{eq:MeasTrnstCDF}
  \pmb{\mpPrb}_{t+1}(\mNrmNxt,~& \permLvlPrbNxt) =  \\ &
                                          \int_{\mNrmNxtBot}^{\mNrmNxt}
                                          \int_{\permLvlPrbNxtBot}^{\permLvlPrbNxt}
                                          \int_{\permLvlPrbNow} 
                                          \int_{\mNrmNow} \lomdkPrb_{t}\left(\mNrmNxt,\mNrmNow,\permShkPrbNxt\right)\mpPrb_{t}(\mNrmNow,\permLvlPrbNow)  d \mNrmNow                                                                                     d \permLvlPrbNow
                                                d F_{\permShk(\permLvlPrbNxt)}
                                                d \mNrmNxt \notag
\end{aligned}\end{equation}
where 
\begin{align*}
  \permShkPrbNxt & = \permLvlPrbNxt/(\PermGroFac \permLvlPrbNow) 
\\    F_{\permShk(\permLvlPrbNxt)} & = \int_{\permShkPrbBot}^{\permShk(\permLvlPrbNxt)} f_{\permShk} d\permShk
    \\ dF_{\permShk(\permLvlPrbNxt)} & = \left(\frac{d (\permLvlPrbNxt/(\PermGroFac \permLvlPrbNow))}{d\permLvlPrbNxt}
                             \right)f_{\permShk}(\permShkPrbNxt) d \permLvlPrbNxt 
\\ & = \left(\frac{1}{\PermGroFac \permLvlPrbNow}                             \right)f_{\permShk}(\permShkPrbNxt) d \permLvlPrbNxt 
  \end{align*}

\cite{harmenbergInvariant}'s first equation corresponds to the marginal density obtained by differentiating the above CDF with respect to $\mNrmNxt$ and $\permLvlPrbNxt$ and says that the `Markov operator that maps a distribution $\mpPrb \in D(\mNrm \times \permLvlPrb)$ to the next-period $\mpPrb$' (that is, defines the dynamics of the joint marginal distribution of $\mNrm$ and $\permLvlPrb$) is given by
\begin{align} \label{eq:MeasTrnst}
\mpPrb_{t+1}(\mNrmNxt,\permLvlPrbNxt) & =
                                          \int_{\permLvlPrbNow} \left[
                                           \int_{\mNrmNow} \lomdkPrb_{t}\left(\mNrmNxt,\mNrmNow,
                                           \overbrace{\frac{\permLvlPrbNxt}{\PermGroFac \permLvlPrbNow}}^{\permShkPrbNxt}\right)\permShkRawPrb(\frac{\permLvlPrbNxt}{\PermGroFac \permLvlPrbNow})\mpPrb_{t}(\mNrmNow,\permLvlPrbNow)\left(\frac{1}{\PermGroFac \permLvlPrbNow}\right)  d \mNrmNow
                                          \right] d \permLvlPrbNow
\end{align}
\newcommand{\nPermShk}{\texttt{i}}\newcommand{\nmNrmVecNow}{\texttt{j}}\newcommand{\nmNrmVecNxt}{\texttt{k}}\newcommand{\npermLvlNow}{\texttt{n}}\newcommand{\npermLvlNxt}{\texttt{q}}

\newcommand{\npermLvlVecNow}{\texttt{n}}\newcommand{\npermLvlVecNxt}{\texttt{q}}\newcommand{\nPermShkNxtFunc}{\iota(\npermLvlVecNow,\npermLvlVecNxt)}\newcommand{\nPermShkVecNxt}{\texttt{i}}
\newcommand{\mNrmVecNow}{\mNrmVec_{t}^{\nmNrmVecNow}}
\newcommand{\mNrmVecNxt}{\mNrmVec_{t+1}^{\nmNrmVecNxt}}
\newcommand{\permShkVecNxt}{\permShk_{t+1}^{\nPermShkVecNxt}}
\newcommand{\permShkVecNow}{\permShk_{t}^{\nPermShkVecNow}}
\newcommand{\permLvlNow}{\permLvlPrb_{t}}
\newcommand{\permLvlNxt}{\permLvlPrb_{t+1}}
\newcommand{\permLvlVecNow}{\permLvlVec_{t}^{\npermLvlVecNow}}
\newcommand{\permLvlVecNxt}{\permLvlVec_{t+1}^{\npermLvlVecNxt}}

\noindent A somewhat awkward notational scheme allows us to define an almost completely parallel representation of the corresponding discrete transition process:
\begin{enumerate}
\item $\{\nPermShk, \nmNrmVecNow, \nmNrmVecNxt\}$ index elements of vectors identifying possible values of $\permShkPrbNxt$, $\mNrmNow$, and $\mNrmNxt$
  \begin{itemize}
  \item We use the capital of the Roman letter to count the number of possible entries
    \item e.g., there are $K$ possible different values for $\mNrmVec:\{\mNrmVec_{t}^{0},\mNrmVec_{t}^{1},...,\mNrmVec_{t}^{K}\}$
    \end{itemize}
\item $\npermLvlVecNow$ indexes the level of permanent income now: $\permLvlVec_{t}[\npermLvlVecNow]$
\item$\lomdkMat_{t}[\nmNrmVecNxt,\nmNrmVecNow,\nPermShk]$ indicates the probability of making a transition from value $\nmNrmVecNow$ of $\mNrmNow$ to value $\nmNrmVecNxt$ of $\mNrmNxt$ given that the realization of $\permShkPrbNxt$ is $\permShkPrbNxt[\nPermShk]$
\item $\permShkVec[\nPermShk]$ is the probability of drawing the $\nPermShk$'th value of $\permShkPrbNxt$
\end{enumerate}
then for a person whose location is described in period $t$ as being at permanent income level $\permLvlVecNow$ and market resources ratio $\mNrmNow[\nmNrmVecNow]$, the elements of the matrix in the next period are given by:
\begin{equation}\begin{aligned} \label{eq:mpMattp1}
  \mpMat_{t+1}[\nmNrmVecNxt,\npermLvlVecNxt] & = \sum_{\npermLvlVecNow} \left(\sum_{\nmNrmVecNow} \lomdkMat_{t}[\nmNrmVecNxt,\nmNrmVecNow,\nPermShkNxtFunc]\permShkVec[\nPermShkNxtFunc]\mpMat_{t}[\nmNrmVecNow,\npermLvlVecNow]  \right)
\end{aligned}\end{equation}
where $\mNrmVec_{t+1}[\nmNrmVecNxt]$ is the $\nmNrmVecNxt$'th element of the vector $\mNrmVec_{t+1}$, $\permLvlVec_{t+1}[\npermLvlVecNxt]$ is the $\npermLvlVecNxt$'th element of $\permLvlVec_{t+1}$, and $\nPermShkNxtFunc$ is a function that calculates the index value of $\nPermShk$ that would achieve the transition from $\permLvlVecNow$ to $\permLvlVec_{t+1}[\npermLvlVecNxt]$.\footnote{Of course, unless the is highly unlikely that $\nPermShkNxtFunc$ would yield an integer unless the elements of $\npermLvlVecNxt$ were chosen as the unique elements defined by all possible combinations of $\permLvlVec_{t}$ and $\permShkVec$; one option is to allocate probabilities in proportion to distance to the nearest integer values of $\nPermShkNxtFunc$ above and below the current point.  (There are other options, which may not be meaningfully better).}$^{,}$\footnote{The $1/\PermGroFac\permLvlNow$ is present in the continuous version but not the discrete version because the latter captures masses and the former captures densities.}
Harmenberg defines 
\begin{align}
     \mpPrbMargRaw_{t}(\mNrmNow) := & \int_{\permLvlPrbNow} \mpPrb_{t}(\mNrmNow,\permLvlPrbNow) d \permLvlPrbNow
\end{align}
which measures the population density of persons whose market resources are $\mNrmNow$.  In matrix terms, the corresponding representation is:
\begin{align}
     \mpMatMargRaw_{t}[\nmNrmVecNow] = & \sum_{\npermLvlVecNow} \mpMat_{t}[\nmNrmVecNow,\npermLvlVecNow] 
\end{align}
which makes it easy to see that $\mpMatMargRaw_{t}[\nmNrmVecNow]$ just measures the total probability mass associated with all possible levels of permanent income for agents at $\mNrmVec_{t}^{\nmNrmVecNow}$.  That is, it tells us \textit{how many agents} have $\mNrmNow=\mNrmVecNow$.

In order to compute the absolute aggregate \textit{amount} of market resources $\mLvlNow$ (boldface indicates levels) owned by people with a market resources \textit{ratio} of $\mNrmVecNow$, we need to know the total \textit{amount} of permanent income accruing to those people:
\begin{align}
  \mLvlNow[\nmNrmVecNow] & = \mNrmVecNow \underbrace{\sum_{\npermLvlVecNow} \permLvlVecNow\mpMat_{t}[\nmNrmVecNow,\npermLvlVecNow]}_{\equiv  \mpMatMargWgt[\nmNrmVecNow]\PermGroFac^{t}}
\end{align}
where $\mpMatMargWgt[\nmNrmVecNow]$ is what Harmenberg calls the Permanent Income Weighted measure.  Under the assumption that aggregate permanent income was 1.0 in period 0 and has grown by the factor $\PermGroFac$ thereafter, the following direct formula for $\mpMatMargWgt$ can be seen to capture the \textit{proportion of aggregate permanent income earned} by people at the given $\mNrmNow$:
\begin{align}
  \mpMatMargWgt[\nmNrmVecNow] & = \PermGroFac^{-t} \sum_{\npermLvlVecNow} \permLvlVecNow\mpMat_{t}[\nmNrmVecNow,\npermLvlVecNow]
\end{align}



With this in hand, it is a simple matter to compute the total aggregate mass of $\MLvl$:
\begin{align}
  \MLvl_{t} & = \PermGroFac^{t} \sum_{\nmNrmVecNow} \mNrmVecNow \mpMatMargWgt[\nmNrmVecNow]
\end{align}
or for that matter consumption:
\begin{align}
  \CLvl_{t} & = \PermGroFac^{t} \sum_{\nmNrmVecNow} \cFunc(\mNrmVecNow) \mpMatMargWgt[\nmNrmVecNow]
\end{align}

Harmenberg formulates his corresponding propositions in the continuous description of the problem using probability measures, e.g.:
\begin{align}
  \mpPrbMargWgt_{t}(\mNrmNow) & = \int_{\permLvlNow} \permLvlNow \mpPrb(\mNrmNow,\permLvlNow) d \permLvlNow
\\ \CLvl_{t} & = \PermGroFac^{t} \int_{\mNrmNow} \cFunc(\mNrmNow) \mpPrbMargWgt(\mNrmNow)                             d \mNrmNow
\end{align}

The point here is `that the permanent-income-weighted distribution is a sufficient statistic for computing aggregate consumption, aggregate savings, and similar aggregate variables'.  Thus, rather than requiring us to keep track of the multidimensional joint distribution over $\mNrm$ and $\permLvl$, we need only know the distribution of permanent-income-weighted $\mNrm$.

The crucial last step is to define the law of motion for the weighted system.  In the continuous formulation, Harmenberg shows (his Theorem 1) that, if we define a `permanent-income-shock-weighted' version of the original permanent shock distribution\footnote{(Harmenberg calls this the `permanent-income-neutral measure,' which is slightly confusing as it does not involve the level of permanent income but only the shocks thereto).} as
\begin{align}
  \permShkWgtPrb(\permShkPrbNxt) & = \permShkPrbNxt \permShkRawPrb(\permShkPrbNxt)
\end{align}
then the laws of motion are respectively given by 
\begin{equation}\begin{aligned}
  \mpPrbMargRaw_{t+1}(\mNrmNxt) & = \int_{\mNrmNow} \int_{\permShkPrbNxt} \lomdkPrb(\mNrmNxt,\mNrmNow,\permShkPrbNxt) \mpPrbMargRaw_{t}(\mNrmNow) \permShkRawPrb(\permShkPrbNxt) d \permShkPrbNxt d \mNrmNow
  \\
  \mpPrbMargWgt_{t+1}(\mNrmNxt) & = \int_{\mNrmNow} \int_{\permShkPrbNxt} \lomdkPrb(\mNrmNxt,\mNrmNow,\permShkPrbNxt) \mpPrbMargWgt_{t}(\mNrmNow) \permShkWgtPrb(\permShkPrbNxt) d \permShkPrbNxt d \mNrmNow
\end{aligned}\end{equation}
(where the difference between the two is the presence or absence of the $\sim$ accent in three places).

The key steps in the proof are the change in variables in which $\permShk_{t+1}=\permLvlNxt/(\PermGroFac \permLvlNow)$ and a change in the order of integration which is permitted by \href{https://en.wikipedia.org/wiki/Fubini\%27s_theorem}{Fubini's theorem}.

Omitting the $\PermGroFac$ term (equivalently, setting it to $\PermGroFac=1$), the discrete version of the proof is \renewcommand{\PermGroFac}{}
\begin{align}
  \mpMatMargWgt[\nmNrmVecNxt] & = \sum_{\npermLvlVecNxt} \permLvlVecNxt\mpMat_{t+1}[\nmNrmVecNxt,\npermLvlVecNxt]
\\   & \approx \sum_{\npermLvlVecNxt} \sum_{\nmNrmVecNow} \sum_{\npermLvlVecNow} \permLvlVecNxt \lomdkMat(\nmNrmVecNxt,\nmNrmVecNow,\npermLvlVecNxt) \permShkWgtVec(\nPermShkNxtFunc)  \mpMat_{t}(\nmNrmVecNow,\npermLvlVecNow)
%  \\   & = \sum_{\nmNrmVecNow} \sum_{\npermLvlVecNxt} \sum_{\npermLvlVecNow} \permLvlVecNxt \lomdkMat(\nmNrmVecNxt,\nmNrmVecNow,\npermLvlVecNxt) \permShkWgtVec(\nPermShkNxtFunc) \mpMat_{t}(\nmNrmVecNow,\npermLvlVecNow)/\permLvlVecNow
\end{align}
% where the last step corresponds to the change in the order of integration in Harmenberg's proof (
and the $\approx$ captures the fact that in the discrete context the necessity to allocate masses to points on the grid will lead to approximation error.

The change of variables is accomplished by realizing that just as there was an $\iota$ that gave us the appropriate $\permShk$ required to get from $\permLvlNow$ to $\permLvlNxt$, we can define a $\koppa(\npermLvlNow,\nPermShkVecNxt)$ that lets us approximate the $\npermLvlNxt$ needed as an argument to $\lomdkMat$ and the index for $\permLvlVecNxt$.  Now we can sum over the permanent shocks indexed by $\nPermShkVecNxt$:
\begin{align}
  \mpMatMargRaw[\nmNrmVecNxt] & =
                                \sum_{\nmNrmVecNow}
                                \sum_{\nPermShkVecNxt}
                                \sum_{\npermLvlVecNow}
                                \permLvlVec_{t+1}^{\koppa(\npermLvlNow,\nPermShkVecNxt)} \lomdkMat(\nmNrmVecNxt,\nmNrmVecNow,\koppa(\npermLvlNow,\nPermShkVecNxt)) \permShkRawVec(\nPermShkVecNxt) \mpMat_{t}(\nmNrmVecNow,\npermLvlVecNow) \\
                             & = 
                                \sum_{\nmNrmVecNow}
                                \sum_{\nPermShkVecNxt}
                                \permLvlVec_{t+1}^{\koppa(\npermLvlNow,\nPermShkVecNxt)} \lomdkMat(\nmNrmVecNxt,\nmNrmVecNow,\koppa(\npermLvlNow,\nPermShkVecNxt)) \permShkRawVec(\nPermShkVecNxt) \mpMatMarg_{t}(\nmNrmVecNow)
\end{align}
where he second line follows because the summation of $\mpMat_{t}(\nmNrmVecNow,\npermLvlVecNow)$ is over $\npermLvlVecNow$ is exactly the step that yields $\mpMatMarg(\mNrmVecNow)$.

The steps for the permanent-income-weighted version of the proposition are identical, with the substitution of weighted for unweighted versions of the various probability objects.



\onlyinsubfile{\pagebreak\input{\LaTeXInputs/bibliography_blend}}


\end{document}



\endinput

\begin{comment}
One way to think about Harmenberg's key insight is to note that if we rewrite \eqref{eq:MeasTrnst} as an explicit function of the transitory and permanent shocks then the integrand becomes
\begin{align} 
%  \mpPrb_{t+1}(\mNrmNxt,\permShkPrbNxt\pLvl_{t}) & =
                                           \lomdkPrb_{t}\left(\overbrace{(\mNrmNow-\cNrm_{t})/(\Rfree \permShkPrbNxt) + \permShkPrbNxt\tranShkNxt}^{\mNrmNxt},\mNrmNow,
\permShkPrbNxt\right)\permShkRawPrb(\permShkPrbNxt)\mpPrb_{t}(\mNrmNow,\permLvlPrbNow)/(\PermGroFac \permShkPrbNxt) \label{eq:integrand}
\end{align}
or 
\begin{align} 
\tilde{\lomdkPrb}_{t}\left(\tranShkNxt(\mNrmNxt),\mNrmNow,
\permShkPrbNxt\right)\permShkRawPrb(\permShkPrbNxt)\mpPrb_{t}(\mNrmNow,\permLvlNow)/(\PermGroFac \permShkPrbNxt) \label{eq:integrand}
\end{align}

But since neither of the first two terms in the integrand \eqref{eq:integrand} involves $\pLvl$ we can change the order of integration 
\begin{align} 
\mpPrbMarg_{t+1}(\mNrmNxt) & = \int_{\mNrmNow} \left[
  \int_{\permShkPrbNxt}  \left(
  \int_{\tranShkNxt} 
  \tilde{\lomdkPrb}_{t}\left(\tranShkNxt,\mNrmNow,
  \permShkPrbNxt\right)
  \mpPrbMarg_{t}(\mNrmNow) \Prb_{\tranShkNxt}(\tranShkNxt)d \tranShkNxt  
  \right) \permShkRawPrb(\permShkPrbNxt) d \permShkPrbNxt\right]
\mathsf{}                                                        d \mNrmNow
\end{align}

\begin{align}
 \log \GPFacRaw & < \sum_{\npermLvlVecNow} \sum_{\npermLvlVecNxt} \log\left( \permShkPrbNxt[\nPermShkNxtFunc] \right) \permShkPrbNxt[\nPermShkNxtFunc] \Prb_{\permShk}(\permShkPrbNxt[\nPermShkNxtFunc]) 
\end{align}

\end{comment}

\pagebreak
Definition 2:  The permanent-income-weighted distribution is defined as 
\newcommand{\mpPrbMargAlt}{\tilde{\mpPrb}^{\mNrm}}
\begin{align}
  \mpPrbMargAlt_{t}(\mNrmNow) & = \PermGroFac^{-t} \int_{\permLvl} \permLvlNow \mpPrb_{t}(\mNrmNow,\permLvlNow) d\permLvlNow
\end{align}

\begin{align}
  \mpPrbMargAlt_{t}[\nmNrmVecNow] & = \PermGroFac^{-t} \sum_{\npermLvlVecNow} \permLvlNow[\npermLvlVecNow] \mpPrb_{t}[\nmNrmVecNow,\npermLvlVecNow] 
\end{align}

So aggregate consumption is
\begin{align}
  \CLvl_{t} & = \int_{\permLvlNow} \left(\int_{\mNrmNow} \cNrm(\mNrmNow) \permLvlNow \mpPrb_{t}(\mNrmNow,\permLvlNow)  d  \mNrmNow\right) d \permLvlNow \\
  l\CLvl_{t} & = \int_{\permLvlNow} \left(\int_{\mNrmNow} \log (\cNrm(\mNrmNow) \permLvlNow) \mpPrb_{t}(\mNrmNow,\permLvlNow)  d  \mNrmNow\right) d \permLvlNow \\
  \\  l\CLvl_{t} & = \int_{\mNrmNow} \underbrace{\left(\int_{\permLvlNow} (\log \cNrm(\mNrmNow)+\log \permLvlNow) \mpPrb_{t}(\mNrmNow,\permLvlNow) d \permLvlNow   \right)}_{\equiv \ell \mpPrbMargAlt(\mNrmNow)} d\mNrmNow
  \\  l\CLvl_{t} & = \int_{\mNrmNow} \left(\log \cNrm(\mNrmNow)+\underbrace{\left(\int_{\permLvlNow} (\log \permLvlNow)    \right)}_{\equiv \ell \mpPrbMargAlt(\mNrmNow)} \right) \mpPrb_{t}(\mNrmNow,\permLvlNow) d \permLvlNow d\mNrmNow
  \\             & = \int_{\mNrmNow} \left(\int_{\permLvlNow} \cNrm(\mNrmNow) \permLvlNow \mpPrb_{t}(\mNrmNow,\permLvlNow) d \permLvlNow   \right) d\mNrmNow           \\   
\\            & = \int_{\mNrmNow} \cNrm(\mNrmNow)\underbrace{\left(\int_{\permLvlNow} \permLvlNow \mpPrb_{t}(\mNrmNow,\permLvlNow) d \permLvlNow   \right)}_{\equiv \mpPrbMargAlt(\mNrmNow)\PermGroFac^{t}} d\mNrmNow
\\  \CLvl_{t} & = \PermGroFac^{t} \int_{\mNrmNow} \cNrm_{t} (\mNrmNow) \mpPrbMargAlt(\mNrmNow) d\mNrmNow
\end{align}
or 
\begin{align}
  \CLvl_{t}  & = \PermGroFac^{t}\sum_{\nmNrmVecNow} \cNrm(\mNrmNow[\nmNrmVecNow])\mpPrbMargAlt[\nmNrmVecNow]
\end{align}

Theorem 1:  The laws of motion for $\mpPrbMarg$ and $\mpPrbMargAlt$ are given by 
\begin{align} 
  \mpPrbMarg_{t+1}(\mNrmNxt) & = \int_{\permShkPrbNxt} \left[
                               \int_{\mNrmNow} \lomdkPrb_{t}
                               \left(
                               \mNrmNxt,\mNrmNow,\permShkPrbNxt\right)
                               \permShkRawPrb(\permShkPrbNxt)\mpPrbMarg_{t}(\mNrmNow)
                               d \mNrmNow
                               \right]
                               d \permShkPrbNxt
\end{align}

\begin{align} 
  \mpPrbMargAlt_{t+1}(\mNrmNxt) & = \int_{\permShkPrbNxt} \left[
                               \int_{\mNrmNow} \lomdkPrb_{t}
                               \left(
                               \mNrmNxt,\mNrmNow,\permShkPrbNxt\right)
                               \permShkWgtPrb(\permShkPrbNxt)\mpPrbMargAlt_{t}(\mNrmNow)
                               d \mNrmNow
                               \right]
                               d \permShkPrbNxt
\end{align}

Proposition 2:  There is a stable invariant permanent-income-weighted distribution $\mpPrbMargAlt$ if
\begin{align}
  \log[\Rfree (1- \MPC)] & < \tilde{\Ex}\log[\PermGroFac \permShkPrbNxt]
\\ \log \GPFacRaw & < \tilde{\Ex}\log[ \permShkPrbNxt]
\\ \log \GPFacRaw & < \int_{\permShk} \log[ \permShkPrbNxt] \permShkPrbNxt f(\permShkPrbNxt) d \permShkPrbNxt
\end{align}


\pagebreak
\begin{align}
  l\bar{\mNrm}_{t} & = \PermGroFac^{t} \int_{\mNrm} l\bar{\mNrm} \mpPrbMargAlt(\mNrm) d \mNrm
  \\ & =                    \PermGroFac^{t} \tilde{\mathbb{M}}[l\mNrm]
\end{align}

\begin{align}
  & = \int_{\permLvlNow} \left(\int_{\mNrmNow} \log \left(\aNrm(\mNrmNow) \permLvlNow\right) \mpPrb_{t}(\mNrmNow,\permLvlNow)  d  \mNrmNow\right) d \permLvlNow \\
 & = \int_{\mNrmNow} \left(\int_{\permLvlNow} \log\left(\aNrm(\mNrmNow) \permLvlNow\right) \mpPrb_{t}(\mNrmNow,\permLvlNow) d \permLvlNow   \right) d\mNrmNow           \\   
 & = \int_{\mNrmNow} \log \aNrm(\mNrmNow)\underbrace{\left(\int_{\permLvlNow} (\log \permLvlNow) \mpPrb_{t}(\mNrmNow,\permLvlNow) d \permLvlNow   \right)}_{\equiv \ell \mpPrbMargAlt(\mNrmNow)\log \PermGroFac^{t}} d\mNrmNow              
\end{align}

\begin{align}
  \tilde{\Ex}[(\log \aNrm_{t+1} - \log \PermGroFac \aNrm_{t})] &
 = \Ex\left[ \tilde{\Ex}[(\log \aNrm_{t+1} - \log \PermGroFac \aNrm_{t})] + \right]
\end{align}




\begin{align} 
  \mpPrb_{t+1}[\nmNrmVecNxt,\npermLvl] & = \sum_{\nPermShk} \left[\sum_{\nmNrmVecNow} \lomdkMat_{t}\left(\mNrmNxt,\mNrmNow,\overbrace{\frac{\permLvlNxt}{\PermGroFac \permLvlNow}}^{\permShkPrbNxt}\right)\permShkRawPrb(\frac{\permLvlNxt}{\PermGroFac \permLvlNow})\mpPrb_{t}(\mNrmNow,\permLvlNow)  d \mNrmNow \right] d \permShkPrbNxt  
\end{align}


% Local Variables:
% eval: (setq TeX-command-list  (remove '("Biber" "biber %s" TeX-run-Biber nil  (plain-tex-mode latex-mode doctex-mode ams-tex-mode texinfo-mode)  :help "Run Biber") TeX-command-list))
% eval: (setq TeX-command-list  (remove '("Biber" "biber %s" TeX-run-Biber nil  t  :help "Run Biber") TeX-command-list))
% eval: (setq TeX-command-list  (remove '("BibTeX" "%(bibtex) LaTeX/%s"    TeX-run-BibTeX nil t :help "Run BibTeX") TeX-command-list))
% eval: (setq TeX-command-list  (remove '("BibTeX" "bibtex LaTeX/%s"    TeX-run-BibTeX nil t :help "Run BibTeX") TeX-command-list))
% tex-bibtex-command: "bibtex ../LaTeX/*"
% TeX-PDF-mode: t
% TeX-file-line-error: t
% TeX-debug-warnings: t
% LaTeX-command-style: (("" "%(PDF)%(latex) %(file-line-error) %(extraopts) -output-directory=../LaTeX %S%(PDFout)"))
% TeX-source-correlate-mode: t
% TeX-parse-self: t
% eval: (cond ((string-equal system-type "darwin") (progn (setq TeX-view-program-list '(("Skim" "/Applications/Skim.app/Contents/SharedSupport/displayline -b %n ../LaTeX/%o %b"))))))
% eval: (cond ((string-equal system-type "gnu/linux") (progn (setq TeX-view-program-list '(("Evince" "evince --page-index=%(outpage) ../LaTeX/%o"))))))
% eval: (cond ((string-equal system-type "gnu/linux") (progn (setq TeX-view-program-selection '((output-pdf "Evince"))))))
% TeX-parse-all-errors: t
% End:
