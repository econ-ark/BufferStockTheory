% -*- mode: LaTeX; TeX-PDF-mode: t; -*-
\input{./.econtexRoot}\documentclass[\econtexRoot/BufferStockTheory]{subfiles}
\input{./.econtexRoot}\input{\LaTeXInputs/econtex_onlyinsubfile} 

\onlyinsubfile{\externaldocument{\LaTeXGenerated/BufferStockTheory}} % Get xrefs -- esp to appendix -- from main file; only works properly if main file has already been compiled;
\begin{document}

\section{Proofs for Theoretical Foundations (Section \ref{sec:Foundations})}

\subsection{Appendix for Problem Formulation}

\subsubsection{Recovering the Non-Normalized Problem}\label{sec:recoverLevels}
Letting nonbold variables be the boldface counterpart normalized by $\permLvl_{t}$ (as with $\mNrm=\mLvl/\permLvl$), consider the problem in the second-to-last period:
\begin{equation}\label{eq:vBold}
  \begin{split}
    \vFuncLvl_{T-1}(\mLvl_{T-1},\permLvl_{T-1})
    & =  \max_{0< \cNrm_{T-1}\leq \mNrm_{T-1}}~
    \uFunc(\permLvl_{T-1}\cNrm_{T-1}) + \DiscFac  \Ex_{T-1} [\uFunc(\permLvl_{T}{\mNrm}
    _{T})]  \\
    & = \permLvl_{T-1}^{1-\CRRA}
    \left\{\max_{0<\cNrm_{T-1}\leq \mNrm_{T-1}}~ \uFunc(\cNrm_{T-1}) + \DiscFac \Ex_{T-1} [ \uFunc( {\PermGroFacRnd}_{T}
      {\mNrm}_{T}) ] \right\}.
  \end{split}
\end{equation}

\hypertarget{The-Related-Problem}{}

Since $\vFunc_{T}(\mNrm_{T}) = \uFunc(\mNrm_{T})$, defining $\vFunc_{T-1}(\mNrm_{T-1})$ from Problem ~\eqref{eq:veqnNrmRecBellman}, we obtain:
\begin{align*}
  \vFuncLvl_{T-1}(\mLvl_{T-1},\permLvl_{T-1})  & = \permLvl_{T-1}^{1-\CRRA} \vFunc_{T-1}(\underbrace{\mLvl_{T-1}/\permLvl_{T-1}}_{=\mNrm_{T-1}}).
\end{align*}

This logic induces to earlier periods; if we solve the normalized one-state-variable problem~\eqref{eq:veqnNrmRecBellman}, we will have solutions to the original problem for any $t<T$ from:
\begin{align*}
  \vFuncLvl_{t}(\mLvl_{t},\permLvl_{t})  & = \permLvl_{t}^{1-\CRRA}\vFunc_{t}(\mNrm_{t}),
  \\ \cLvl_{t}(\mLvl_{t},\permLvl_{t})  & = \permLvl_{t}\cFunc_{t}(\mNrm_{t}).
\end{align*}


\subsubsection{Challenges with Standard Dynamic Programming Approaches}\label{subsubsec:challenges}

\subsubsection{Infinite Horizon Stochastic Dynamic Optimization Problem}\label{subsubsec:infiniteSDPappx}

How does the  \hyperlink{Definition-of-a-Nondegenerate-Solution}{limiting nondegenerate solution} connect to the solution of an infinite horizon stochastic dynamic optimization problem \citep{hlermaSDS1995,puterman1994, stachurski2022}? The two problems are equivalent when the converged value function, $\vFunc$, is a fixed point of the stationary Bellman operator $\mathbb{T}$, and the nondegenerate consumption function is $\vFunc$-greedy, that is,  Equation \eqref{eq:stationarybellman} holds. Given the particular approach taken by Theorem \ref{thm:convgtobellman}, and to aid the interpretation of our discussion on aggregate relationships, we state the standard result formally and present a proof Appendix \ref{sec:infiniteSDPappx}. 

Let a sequence of shocks $\{\permShk_{k},\tranShkAll_{k}\}_{k=0}^{\infty}$ be defined on a common probability space, $(\Omega, \Sigma, \mathbb{P})$, and fix the problem primitives defined in Section \ref{subsec:Setup}. Consider the value function for stochastic infinite horizon sequence problem:
%
\begin{equation}\label{eq:probsequence}
\vFuncRnd(\mNrm) = \max_{\left\{\tilde{\cNrm}_{k}\right\}_{k=0}^{\infty}} \Ex\,\sum_{k=0}^{\infty}\DiscFac^{k}\Pi_{j=0}^{k}\PermGroFacRnd_{j}\uFunc(\tilde{\cNrm}_{k}), \qquad \mNrm\in S \tag{$\mathscr{P}_{\infty}$}
\end{equation}
%
%
such that i) $\left\{\tilde{\cNrm}_{k}\right\}_{k=0}^{\infty}$ is a sequence of random variables defined on $(\Omega, \Sigma, \mathbb{P})$, progressively measurable with respect to the shocks $\{\permShk_{k},\tranShkAll_{k}\}_{k=0}^{\infty}$, ii) the inter-temporal budget constraint holds almost everywhere: $\mNrmRnd_{k+1} = \RNrm_{k}(\mNrmRnd_{k} - \cNrmRnd_{k}) + \tranShkAll_{k}$, iii) the cannot die in debt condition holds almost everywhere in the limit: $\lim\limits_{k\rightarrow \infty}{\mNrmRnd_{k}}\geq 0$ and iv) $\mNrmRnd_{0} = m$. The expectation $\Ex$ is taken with respect to $\mathbb{P}$. 

\begin{proposition}
Let the assumptions of Theorem \ref{thm:convgtobellman} hold. If $\vFunc$ and $\cFunc$ are a limiting nondegenerate solution, them $\vFunc= \vFuncRnd$ and the sequence $\left\{\cNrmRnd_{k}\right\}_{k=0}^{\infty}$ generated by  $\cNrmRnd_{k} = \cFunc(\mNrmRnd_{k})$, where $\mNrmRnd_{k+1} = \RNrm_{k}(\mNrmRnd_{k} -  \cFunc(\mNrmRnd_{k})) + \tranShkAll_{k}$, solves Problem \eqref{eq:probsequence}. 
\end{proposition}

The proposition, an implication of the Bellman Principle of Optimality, says that an individual following the nondegenerate consumption rule has maximized the expected discounted sum of their future per-period utilities.


\subsection{Perfect Foresight Benchmarks}\label{sec:PFBProofs}\hypertarget{}{PFBProofs}


How do the \hyperlink{FHWC}{finite value of human wealth}, \hyperlink{PFFVAC}{perfect foresight finite value of autarky} and \hyperlink{RIC}{return impatience} relate to each other? If the {\FHWC} is satisfied, the {\PFFVAC} implies that the {\RIC} is satisfied.\footnote{Divide both sides of the second inequality in~\eqref{eq:PFFVAC} by $\Rfree$:
%
%
  \begin{align*}
    \APFac/\Rfree & < {(\PermGroFac/\Rfree)}^{1-1/\CRRA}  \label{eq:FHWCandPFFVACimplyRIC}
  \end{align*}
  and {\FHWC} $\Rightarrow$ the RHS is $< 1$ because $(\PermGroFac/\Rfree) < 1$ (and the RHS is raised to a positive power (because $\CRRA>1$)).}  Likewise, if the {\FHWC} and the {\GICRaw} are both satisfied, {\PFFVAC} follows:
  
\begin{equation}\label{eq:GICandFHWCimplyPFFVAC}
  \begin{split}
    \APFac & < \PermGroFac < \Rfree
    \\   \RPFac & < \PermGroFac/\Rfree < {(\PermGroFac/\Rfree)}^{1-1/\CRRA} < 1
  \end{split}
\end{equation}
(the last line holds because {\FHWC} $\Rightarrow 0 \leq (\PermGroFac/\Rfree) < 1$ and $\CRRA > 1 \Rightarrow 0 < 1-1/\CRRA < 1$).

Divide both sides of the second inequality in~\eqref{eq:PFFVAC} by $\Rfree$:
  \begin{align}
    \APFac/\Rfree & < {(\PermGroFac/\Rfree)}^{1-1/\CRRA}  \label{eq:FHWCandPFFVACimplyRIC}
  \end{align}
  and {\FHWC} $\Rightarrow$ the RHS is $< 1$ because $(\PermGroFac/\Rfree) < 1$ (and the RHS is raised to a positive power (because $\CRRA>1$)).

The first panel of Table~\ref{table:Required} summarizes: The PF-Unconstrained model has a nondegenerate limiting solution if we impose the {\RIC} and {\FHWC} (these conditions are necessary as well as sufficient).  Together the {\PFFVAC} and the {\FHWC} imply the {\RIC}.  If we impose the {\GICRaw} and the {\FHWC}, both the {\PFFVAC} and the {\RIC} follow, so {\GICRaw}+{\FHWC} are also sufficient.  But there are circumstances under which the {\RIC} and {\FHWC} can hold while the {\PFFVAC} fails (`\cncl{\PFFVAC}').  For example, if $\PermGroFac=0$, the problem is a standard `cake-eating' problem with a nondegenerate solution under the {\RIC} (when the consumer has access to capital markets).% chktex 10



\subsection{Properties of the Consumption Function and Limiting MPCs}\label{sec:MPCiterproofs}


We start by stating some properties of the value functions generated by Problem~\eqref{\localorexternallabel{eq:veqnNrmRecBellman}}.  


\begin{lemma}\label{lemm:consC2}
If $\vFunc_{t}$ is strictly negative, strictly increasing, strictly concave, $\mathbf{C}^{3}$ and satisfies $\lim\limits_{\mNrm\rightarrow 0}~\vFunc_{t}(\mNrm) =-\infty $, then $\cNrm_{t}$ is in $\mathbf{C}^{2}$. 
\end{lemma}

\begin{proof}

\hypertarget{BoroCnstNat}{}
Now define an end-of-period value function $\mathfrak{v}_{t}(a) $ as:
\begin{equation}\label{eq:vfFrackdefn}
  \mathfrak{v}_{t}(a) =\DiscFac \Ex_{t}\left[{\PermGroFacRnd}_{t+1}^{1-\CRRA}\vFunc_{t+1}\left({\RNrm}_{t+1} a+{\tranShkAll}_{t+1}\right) \right].% \label{eq:vEnd}
\end{equation}

Since there is a positive probability that $\tranShkAll_{t+1}$ will
attain its minimum of zero and since ${\RNrm}_{t+1}>0$, it
is clear that $\lim\limits_{\aNrm \rightarrow 0} \mathfrak{v}_{t}(a) = -\infty$
and $\lim\limits_{\aNrm \rightarrow 0} \mathfrak{v}^{\prime}_{t}(a) = \infty$.  So
$\mathfrak{v}_{t}(a) $ is well-defined iff $\aNrm>0$; it is similarly
straightforward to show the other properties required for $\mathfrak{v}_{t}(a) $ \textcolor{red}{to
be satisfy the properties of the Proposition.  (See \cite{hiraguchiBSProofs}.)}

Next define $\underline{\vFunc}_{t}(\mNrm,\cNrm)$ as:
%
%
\begin{equation}
  \underline{\vFunc}_{t}(\mNrm,\cNrm)=\uFunc(c)+\mathfrak{v}_{t}(\mNrm-c). 
\end{equation}
%
Note that for fixed $\mNrm$, $\cNrm \mapsto \underline{\vFunc}_{t}(\mNrm,\cNrm)$ is $\mathbf{C}^{3}$ on $(0, \mNrm)$ since $\mathfrak{v}_{t}$ and $\uFunc$ are both
$\mathbf{C}^{3}$. Next,  observe that our problem's value function defined
by Problem~\eqref{\localorexternallabel{eq:veqnNrmRecBellman}} can be written as:
%
%
%
\begin{equation}\begin{gathered}\begin{aligned}
      \vFunc_{t}(\mNrm)  & =  \max_{\cNrm}~\underline{\vFunc}_{t}(\mNrm,\cNrm), 
    \end{aligned}\end{gathered}\end{equation}

where the function $\underline{\vFunc}_{t}$ is well-defined if and only if $0<c<m$.  Furthermore,
$\lim\limits_{c \rightarrow
  0}\underline{\vFunc}_{t}(\mNrm,\cNrm)=\lim\limits_{c\rightarrow m} \underline{\vFunc}_{t}(\mNrm,\cNrm)=-\infty $, $\frac{\partial ^{2}\underline{\vFunc}_{t}(\mNrm,\cNrm)}{\partial c^{2}}%
<0$, $\lim\limits_{\cNrm \rightarrow 0}\frac{\partial \underline{\vFunc}_{t}(\mNrm,\cNrm)}{\partial c}%
=+\infty $, and $\lim\limits_{\cNrm\rightarrow m} \frac{\partial \underline{\vFunc}_{t}(\mNrm,\cNrm)}{%
  \partial c}=-\infty $. It follows that the $\cFunc_{t}(\mNrm)$ defined by:
  %
  %
  %
\begin{equation}\begin{gathered}\begin{aligned}
      \cFunc_{t}(\mNrm)  & = \underset{0<c<m}{\arg \max }~\underline{\vFunc}_{t}(\mNrm,\cNrm)
    \end{aligned}\end{gathered}\end{equation}
exists and is unique and Problem~\eqref{\localorexternallabel{eq:veqnNrmRecBellman}} has an interior
solution. Moreover, by Berge's Maximum Theorem, $\cFunc_{t}$ will be continuous on $S$. Next, note that $\cFunc_{t}$ satisfies the first order condition:
%
%
%
\begin{equation}
  \uFunc^{\prime }(\cFunc_{t}(\mNrm))=\mathfrak{v}_{t}^{\prime }(\mNrm-\cFunc_{t}(\mNrm))  \label{eq:consumptionf}.
\end{equation}
%
%
By the Implicit Function Theorem, we then have that $\cFunc_{t}$ is differentiable and:
%
%
\begin{equation}\label{eq:derivativeConsFunc}\begin{gathered}\begin{aligned}
      \cFunc_{t}^{\prime }(\mNrm)  & = \frac{\mathfrak{v}_{t}^{\prime \prime }({\aFunc}_{t}(\mNrm))  }{\uFunc^{\prime \prime }(\cFunc_{t}(\mNrm))+\mathfrak{v}_{t}^{\prime \prime }({\aFunc}_{t}(\mNrm))}.
    \end{aligned}\end{gathered}\end{equation}
%
%
Since both $\uFunc$ and $\mathfrak{v}_{t}$ are
three times continuously differentiable and $\cFunc_{t}$ is continuous, the RHS of the above equation is continuous and we can conclude that
$\cFunc_{t}^{\prime }$ is continuous and $\cFunc_{t}$ is in $\mathbf{C}^{1}$. 

Finally, $\cFunc_{t}^{\prime }(\mNrm)$ is differentiable because
$\mathfrak{v}_{t}^{\prime \prime }$ is $\mathbf{C}^{1}$, $ \cFunc_{t}(\mNrm)$
is $\mathbf{C}^{1}$ and $\uFunc^{\prime \prime
}(\cFunc_{t}(\mNrm))+\mathfrak{v}_{t}^{\prime \prime }\left( {\aFunc}_{t}(\mNrm)\right)
<0$. The second derivative $\cFunc_{t}^{\prime \prime }(\mNrm)$ will be given by:
%
%
%
\begin{equation}
  \cFunc_{t}^{\prime \prime }(\mNrm)=\frac{{\aNrm}_{t}^{\prime }(\mNrm)\mathfrak{v}_{t}^{\prime \prime
      \prime }({\aNrm}_{t})\left[ \uFunc^{\prime \prime }(c_{t})+\mathfrak{v}_{t}^{\prime \prime }({\aNrm}_{t})
    \right] -\mathfrak{v}_{t}^{\prime \prime }({\aNrm}_{t})\left[ c_{t}^{\prime }\uFunc^{\prime \prime
        \prime }(c_{t})+{\aNrm}_{t}^{\prime }\mathfrak{v}_{t}^{\prime \prime \prime }({\aNrm}_{t})\right] }{
    {\left[ \uFunc^{\prime \prime }(c_{t})+\mathfrak{v}_{t}^{\prime \prime }({\aNrm}_{t})\right]}^{2}}.
\end{equation}
Since $\mathfrak{v}_{t}^{\prime \prime }({\aFunc}_{t}(\mNrm))$ is continuous,
$\cFunc_{t}^{\prime \prime }(\mNrm)$ is also continuous.
%
%

\end{proof}


\begin{proposition}\label{prop:vfc3}
For each $t$, $\vFunc_{t}$ is strictly negative, strictly increasing, strictly concave, $\mathbf{C}^{3}$ and satisfies $\lim\limits_{\mNrm\rightarrow 0}~\vFunc_{t}(\mNrm) =-\infty $.
\end{proposition}

\begin{proof}

We will say a function is `nice' if it satisfies the properties stated by the Proposition. Assume that for some $t+1$, $\vFunc_{t+1}$ is nice.  Our objective is to show that this
implies $\vFunc_{t}$ is also nice; this is sufficient to establish that
$\vFunc_{t-n}$ is nice by induction for all $n > 0$ because $\vFunc_{T}(\mNrm)
=\uFunc(\mNrm) $ and $\uFunc$, where $\uFunc(\mNrm)=\mNrm^{1-\CRRA}/(1-\CRRA)$, is nice by inspection. By Lemma~\ref{lemm:consC2}, if $\vFunc_{t+1}$ is nice, $\cNrm_{t}$ is in $\mathbf{C}^{2}$. Next, since both $\uFunc$ and $\mathfrak{v}_{t}$ are strictly concave, both
$\cFunc_{t}$ and $\aFunc_{t}$, where $\aFunc_{t}(\mNrm)=\mNrm-\cFunc_{t}(\mNrm)$,
are strictly increasing (Recall Equation \eqref{eq:derivativeConsFunc}).  This implies that
$\vFunc_{t}(\mNrm)$ is nice, since
$\vFunc_{t}(\mNrm)=\uFunc(\cFunc_{t}(\mNrm))+\mathfrak{v}_{t}({\aFunc}_{t}(\mNrm))$.
\end{proof}

 
\hypertarget{cFunc-is-Twice-Continuously-Differentiable}{}
\begin{proof}[\textbf{\textit{Proof for Proposition \ref{prop:cfuncprop}}}]

By Proposition~\ref{prop:vfc3}, each $\vFunc_{t}$ is strictly negative, strictly increasing, strictly concave, $\mathbf{C}^{3}$ and satisfies $\lim\limits_{\mNrm\rightarrow 0}~\vFunc_{t}(\mNrm) =-\infty $. As such, apply Lemma \ref{lemm:consC2} to conclude the result. 

\end{proof}


\begin{comment}
\textcolor{blue}{Add remaining links to proof of existence of MPCs. Check use of DMC.}
\end{comment}

\begin{proof}[\textbf{Proof of Lemma \ref{lemm:MPC} (Limiting MPCs)}]

\vspace{0.7em} % Add some space before the heading
\noindent\textit{Proof of (i): Minimal MPC}  % Make it bold and larger
\vspace{0.7em} % Add some space after the heading

Fix any $t$ and for any $\mNrm_{t}$ with  $\mNrm_{t}>0$, we can define $\eFunc_{t}(\mNrm_{t})=\cFunc_{t}(\mNrm_{t})/\mNrm_{t}$ and $\aFunc_{t}(\mNrm_{t})= \mNrm_{t} -\cFunc_{t}(\mNrm_{t})$. The Euler equation, Equation~\eqref{\localorexternallabel{eq:scaledeuler}}, can be rewritten as:


\begin{equation}\begin{gathered}\begin{aligned}\label{eq:eFuncEuler}
 \eFunc_{t}{(\mNrm_{t})}^{-\CRRA}  & = \DiscFac \Rfree \Ex_{t}{\left(\eFunc_{t+1}({\mNrm}_{t+1})\left(\frac{\overbrace{\Rfree \aFunc_{t}(\mNrm)+{\PermGroFacRnd}_{t+1}{\tranShkAll}_{t+1}}^{={\mNrm}_{t+1} \PermGroFacRnd_{t+1}}}{\mNrm_{t}}\right)\right)}^{-\CRRA }
\end{aligned}\end{gathered}\end{equation}
%
%

where ${\mNrm}_{t+1} = \RNrm_{t+1}(\mNrm_{t} -\cFunc_{t}(\mNrm_{t})) +\tranShkAll_{t+1}$. The minimal MPC's are obtained by letting where $\mNrm_{t} \rightarrow \infty$. Note that $\lim\limits_{\mNrm_{t}\rightarrow \infty} \mNrm_{t+1} = \infty$ almost surely and thus $\lim\limits_{\mNrm_{t}\rightarrow \infty}\eFunc_{t+1}({\mNrm}_{t+1}) = \MPCmin_{t+1}$ almost surely. Turning to the second term inside the marginal utility on the RHS, we can write:

\begin{align}
\lim_{\mNrm_{t}\rightarrow \infty}\frac{\Rfree \aFunc_{t}(\mNrm_{t})+{\PermGroFacRnd}_{t+1}{\tranShkAll}_{t+1}}{\mNrm_{t}} &  = \lim_{\mNrm_{t}\rightarrow \infty}\frac{\Rfree \aFunc_{t}(\mNrm_{t})}{\mNrm_{t}} + \lim_{\mNrm_{t}\rightarrow \infty}\frac{{\PermGroFacRnd}_{t+1}{\tranShkAll}_{t+1}}{\mNrm_{t}} \\
			& = \Rfree (1- \MPCmin_{t}) + 0, 
\end{align}
since ${\PermGroFacRnd}_{t+1}{\tranShkAll}_{t+1}$ is bounded. Thus, we can assert:

\begin{equation}
\lim_{\mNrm_{t}\rightarrow \infty}{\left(\eFunc_{t+1}({\mNrm}_{t+1})\left(\frac{\Rfree \aFunc_{t}(\mNrm)+{\PermGroFacRnd}_{t+1}{\tranShkAll}_{t+1}}{\mNrm_{t}}\right)\right)}^{-\CRRA } = (\Rfree\MPCmin_{t+1}(1-\MPCmin_{t}))^{-\gamma}, 
\end{equation}

almost surely. Next, the term inside the expectation operator at Equation \eqref{eq:eFuncEuler} is bounded above by $\left(\Rfree\MPCmin_{t+1}(1-\MPCmax_{t})\right)^{-\gamma}$. Thus, by the Dominated Convergence Theorem, we have:

\begin{equation}\label{eq:eFuncEulerMPCmaxDCT}
\lim_{\mNrm_{t}\rightarrow \infty}{\DiscFac \Rfree \Ex_{t}\left(\eFunc_{t+1}({\mNrm}_{t+1})\left(\frac{\Rfree \aFunc_{t}(\mNrm_{t})+{\PermGroFacRnd}_{t+1}{\tranShkAll}_{t+1}}{\mNrm_{t}}\right)\right)}^{-\CRRA } = \DiscFac \Rfree(R\MPCmin_{t+1}(1-\MPCmin_{t}))^{-\gamma}. 
\end{equation}

Again applying L'H\^opital's rule to the LHS of Equation \eqref{eq:eFuncEuler}, letting $\lim_{\mNrm \rightarrow \infty} \eFunc_{t}(\mNrm) = \MPCmin_{t}$ and equating limits to the RHS, we arrive at: \hypertarget{MPCnvrs}{}

\begin{equation*}
 \MPSmax \MPCmin_{t}  =  (1-\MPCmin_{t}) \MPCmin_{t+1}
\end{equation*}

The minimal marginal propensity to consume satisfies the following recursive formula:
\begin{equation}\begin{gathered}\begin{aligned}
 \MPCmin_{t}^{-1}  & = 1+\MPCmin_{t+1}^{-1}\MPSmax,  \label{eq:MPCminInvApndx}
\end{aligned}\end{gathered}\end{equation}

which implies ${(\{\MPCmin_{T-n}^{-1}\})}_{n=0}^{\infty}$ is an increasing
convergent sequence. Define:
\begin{equation}\begin{gathered}\begin{aligned}
\MPCmin^{-1} \colon = &\lim_{n \rightarrow \infty} \MPC_{T-n}^{-1}  
\end{aligned}\end{gathered}\end{equation}
as the limiting (inverse) marginal MPC. If the \RIC~does \textit{not} hold, then $\lim\limits_{n \rightarrow \infty} \MPCmin_{T-n}^{-1} = \infty$
and so the limiting MPC is $\MPCmin = 0$. Otherwise if \RIC~holds, then $\MPCmin > 0$.

\vspace{0.7em} % Add some space before the heading
\noindent\textit{Proof of (ii): Maximal MPC}  % Make it bold and larger
\vspace{0.7em} % Add some space after the heading

The Euler Equation~\eqref{\localorexternallabel{eq:scaledeuler}} can be rewritten as:


\begin{equation}\begin{gathered}\begin{aligned}\label{eq:eFuncEulerMPCmax}
 \eFunc_{t}{(\mNrm_{t})}^{-\CRRA}  & = \DiscFac \Rfree \Ex_{t}\left[{\left(\eFunc_{t+1}({\mNrm}_{t+1})\left(\frac{\overbrace{\Rfree \aFunc_{t}(\mNrm)+{\PermGroFacRnd}_{t+1}{\tranShkAll}_{t+1}}^{={\mNrm}_{t+1} \PermGroFacRnd_{t+1}}}{\mNrm_{t}}\right)\right)}^{-\CRRA }\right] 
\\  & = \phantom{ + }\pNotZero \DiscFac \Rfree \mNrm_{t}^{\CRRA} \Ex_{t}\left[ {\left(\eFunc_{t+1}({\mNrm}_{t+1} ) {\mNrm}_{t+1} \PermGroFacRnd_{t+1}\right)}^{-\CRRA} |~ \tranShkAll_{t+1}>0 \right] 
\\ & \qquad\qquad  + \pZero  \DiscFac \Rfree^{1-\CRRA} \Ex_{t}\left[{\left(\eFunc_{t+1}(\RNrm_{t+1}\aFunc_{t}(\mNrm))\frac{\mNrm_t-\cFunc_{t}(\mNrm)}{\mNrm_{t}}\right)}^{-\CRRA} |~ \tranShkAll_{t+1} = 0 \right]  
\end{aligned}\end{gathered}\end{equation}
%
%
Now consider the first conditional expectation in the second line of Equation ~\eqref{\localorexternallabel{eq:eFuncEulerMPCmax}}. Recall that if $\tranShkAll_{t+1}>0$, then $\tranShkAll_{t+1} =
\tranShkEmp_{t+1}/\pNotZero$ by Assumption \ref{ass:shocks}.  Since $\lim\limits_{\mNrm_{t} \rightarrow 0}
\aFunc_{t}(\mNrm_{t}) = 0$,
$\Ex_{t}[{(\eFunc_{t+1}({\mNrm_{t}}^{\prime} ){\mNrm_{t}}^{\prime} \PermGroFac_{t+1})}^{-\CRRA}~|~\tranShkAll_{t+1}>0]$
is contained in the bounded interval
$[{(\eFunc_{t+1}(\underline{\tranShkEmp}/\pNotZero) \PermGroFac\underline{\permShk}
\underline{\tranShkEmp}/\pNotZero)}^{-\CRRA}, {(\eFunc_{t+1}(\bar{\tranShkEmp}/\pNotZero) \PermGroFac\bar{\permShk}
\bar{\tranShkEmp}/\pNotZero)}^{-\CRRA}]$. As such, the first term after the second equality above converges to zero as
$\mNrm_{t}^{\CRRA}$ converges to zero. 

Turning to the second term after the second equality above, once again apply Dominated Convergence Theorem as noted above at Equation \eqref{eq:eFuncEulerMPCmaxDCT}. As $\mNrm_{t} \rightarrow 0$, 
the expectation converges to $\MPCmax _{t+1}^{-\CRRA
}{(1-\MPCmax _{t})}^{-\CRRA }$. 

Equating the limits on the LHS and RHS of Equation \eqref{\localorexternallabel{eq:eFuncEulerMPCmax}}, we have $\MPCmax_{t}^{-\CRRA }=\DiscFac
\pZero\Rfree^{1-\CRRA }\MPCmax_{t+1}^{-\CRRA }{(1-\MPCmax
_{t})}^{-\CRRA }$. Exponentiating by $\CRRA$ on both sides, we can conclude:
%
%
\begin{equation}\begin{gathered}\begin{aligned}
\MPCmax_{t} & = \pZero^{-1/\CRRA} {(\DiscFac
\Rfree)}^{-1/\CRRA}\Rfree(1-\MPCmax _{t})\MPCmax _{t+1} \notag
\end{aligned}\end{gathered}\end{equation}
%
%
and, 
%
%
\begin{equation}
 \underbrace{\pZero^{1/\CRRA}\overbrace{{\Rfree}^{-1}{(\DiscFac
    \Rfree)}^{1/\CRRA}}^{\RPFac}}_{\equiv \MPSmin} \MPCmax_{t}  = (1-\MPCmax _{t})\MPCmax _{t+1} \label{eq:MPSminDef}
\end{equation}
%
%
The equation above yields a useful recursive formula for the maximal marginal propensity to consume after some algebra:
%
%
\begin{equation}\begin{gathered}\begin{aligned}
  {(\MPSmin \MPCmax_{t})}^{-1}  & = {(1-\MPCmax_{t})}^{-1}\MPCmax_{t+1}^{-1}  \notag
\\ \Rightarrow \MPCmax_{t}^{-1}(1-\MPCmax_{t})  & = \MPSmin \MPCmax_{t+1}^{-1}   \notag
\\ \Rightarrow  \MPCmax_{t}^{-1}  & = 1+\MPSmin \MPCmax_{t+1}^{-1} \label{eq:MPCmaxInvApndx}
\end{aligned}\end{gathered}\end{equation}
%
%
As noted in the main text, we need the \WRIC~\eqref{\localorexternallabel{eq:WRIC}} for this to be a convergent sequence:
\begin{equation}\begin{gathered}\begin{aligned}
  0 \leq & ~\pZero^{1/\CRRA} \RPFac < 1 \label{eq:WRICapndx},
\end{aligned}\end{gathered}\end{equation}

Since $\MPCmax_{T}=1$, iterating~\eqref{\localorexternallabel{eq:MPCmaxInvApndx}} backward to
infinity (because we are interested in the limiting consumption function) we obtain:
\begin{equation}\begin{gathered}\begin{aligned}
\lim_{n\rightarrow\infty}\MPCmax_{T-n} 
& = \MPCmax \equiv 1-\pZero^{1/\CRRA}\RPFac  \label{eq:MPCmaxDef}
\end{aligned}\end{gathered}\end{equation}


%and we will therefore call $\MPCmax$ the `limiting maximal MPC.'


\end{proof}

\hypertarget{It-Is-A-Contraction-Mapping}{}
\subsection{Existence of Limiting Solutions}\label{sec:Tcontractionmapping}

We state Boyd's contraction mapping Theorem (Boyd,1990) for completeness. 

\begin{theorem}(Boyd's Contraction Mapping)
Let $\mathbb{B}:\mathcal{C}_{\boundFunc }\left( S,Y\right)
  \rightarrow \mathcal{C}_{\boundFunc }\left(S,Y\right) $. If, 
\begin{enumerate}
  \item the operator $\mathbb{B}$ is non-decreasing, i.e.\ ${x} \leq {y}\Rightarrow\mathbb{B}{x} \leq \mathbb{B}{y}$,
  \item we have $\mathbb{B}\mathbf{0}\ in ~ \mathcal{C}_{\boundFunc }\left(S,Y\right) $, where $\mathbf{0}$ is the null vector,
  \item there exists some real $0 < \alpha < 1$ such that for all $\zeta$ with $\zeta > 0$, we have:
             $$\mathbb{B}({x} +\zeta\boundFunc ) \leq \mathbb{B}{x} +\zeta\alpha \boundFunc,$$
\end{enumerate}
then $\mathbb{B}$ defines a contraction with a unique fixed point.
\end{theorem}

To prepare for the main contraction mapping proof, the following claim will allow us to employ the \WRIC~ (Assumption \ref{ass:WRIC}) to show  $\TMap^{\underline{b}, \bar{b}}f$ maps $\boundFunc-$bounded functions to $\boundFunc-$bounded for $k$ large enough and $\MPCmax_{k} \geq \bar{b}$,  with $\MPCmax_{k}$ close enough to $\MPCmax$. 

\begin{claim}\label{claim: MPCMAXKleq1}
If \WRIC~ (Assumption \ref{ass:WRIC}) holds, then there exists $k$ such that:
%
%
\begin{equation}\label{eq: MPCMAXKleq1}
  \pZero \DiscFac {(\Rfree (1-\MPCmax_{k}))}^{1-\CRRA}   < 1
\end{equation}
%
\end{claim}
\begin{proof}

By straight-forward algebra, we have:

\begin{align}
\pZero \DiscFac {(\Rfree (1-\MPCmax))}^{1-\CRRA}  & = \pZero\DiscFac\Rfree^{1-\CRRA}{\left(\pZero^{1/\CRRA}\frac{{(\Rfree\DiscFac)}^{1/\CRRA}}{\Rfree}\right)}^{1-\CRRA} \\\notag
& = \pZero^{1/\CRRA}\frac{{(\Rfree\DiscFac)}^{1/\CRRA}}{\Rfree} <1 \notag
\end{align}

where the inequality holds by the \WRIC ~ (Assumption \ref{ass:WRIC}). Finally, since the expression $\pZero \DiscFac {(\Rfree (1-\MPCmax_{k}))}^{1-\CRRA} $ is continuous as a function of $\MPCmax_{k}$, and we have $\bar{\kappa}>0$ and $\MPCmax_{t} \rightarrow \MPCmax$, by the definition of continuity, there exists $k$ such that Equation \eqref{eq: MPCMAXKleq1} holds. 
\end{proof}

\begin{proof}[\textbf{Proof of Theorem \ref{thm:convgtobellman}}]
Fix $k$ such that Equation \eqref{eq: MPCMAXKleq1} holds. To show $\TMap^{\underline{b}, \bar{b}} f$ satisfies the condition of Theorem \ref{thm:cmap}, we first need to show  $\TMap^{\underline{b}, \bar{b}} f$ maps from $\mathcal{C}_{\boundFunc}(S,Y)$ to $\mathcal{C}_{\boundFunc}(S,Y)$. A preliminary requirement is therefore that $\TMap^{\underline{b}, \bar{b}} \fFunc$ be continuous for any $\boundFunc-$bounded $\fFunc$, $\TMap^{\underline{b}, \bar{b}} \fFunc  \in~\mathcal{C}(S,\mathbb{R})$.  This is not difficult to show; see \cite{hiraguchiBSProofs}.



\vspace{0.7em} % Add some space before the heading
\noindent\textit{Proof of Condition 1}  % Make it bold and larger
\vspace{0.7em} % Add some space after the heading

Consider condition (1). For this problem,
\begin{align*}
  \TMap^{\underline{b}, \bar{b}}{\fFunc}(\mNrm) & = \underset{\cNrm \in
                                            [\underline{b} \mNrm, \bar{b} \mNrm]
                                            }\max \left\{
                                            \uFunc(c)+\DiscFac \Ex{\PermGroFacRnd}\fFunc
                                            \left({\mNrm^{\prime}}\right) \right\}  \notag  \label{eq:condition1}
  \\
  \TMap^{\underline{b}, \bar{b}}{\gFunc}(\mNrm) &= \underset{\cNrm \in
                                            [\underline{b} \mNrm, \bar{b} \mNrm]
                                            }\max \left\{
                                            \uFunc(c)+\DiscFac \Ex \PermGroFacRnd^{\prime} \gFunc
                                            \left( \mNrm^{\prime}\right)\right\} ,  \notag
\end{align*}%
so $\fFunc \leq \gFunc$ implies $\TMap^{\underline{b}, \bar{b}} \gFunc \leq \TMap^{\underline{b}, \bar{b}} \gFunc $ pointwise by inspection.\footnote{For a fixed $\mNrm$, recall that ${\mNrm}_{t+1}$ is just a function of $c_{t}$ and the
  stochastic shocks.}


\vspace{0.7em} % Add some space before the heading
\noindent\textit{Proof of Condition 2}  % Make it bold and larger
\vspace{0.7em} % Add some space after the heading


Condition (2) requires that $\TMap^{\underline{b}, \bar{b}}\mathbf{0}\in \mathcal{C}_{\boundFunc}\left(\mathscr{S},\mathscr{Y}\right)$. By definition,
\begin{equation*}
  \TMap^{\underline{b}, \bar{b}} \mathbf{0}(\mNrm) = \max_{\cNrm \in
    [\underline{b}, \mNrm, \bar{b} \mNrm]
  }\left\{ \left( \frac{\cNrm^{1-\CRRA }}{1-\CRRA }\right) +\DiscFac 0\right\}
\end{equation*}
the solution to which is
$\uFunc(\bar{b} \mNrm)$. Thus, condition (2)
will hold if ${(\bar{b} \mNrm)}^{1-\CRRA}$ is $\boundFunc$-bounded, which it is if we use the
bounding function
\input{\econtexRoot/\EqDir/boundFunc}
defined in the main text.


\vspace{0.7em} % Add some space before the heading
\noindent\textit{Proof of Condition 3}  % Make it bold and larger
\vspace{0.7em} % Add some space after the heading


Finally, we turn to condition (3). We wish to show that there exists $\alpha \in (0,1)$ such that $\TMap^{\underline{b}, \bar{b}}(\fFunc +\zeta\boundFunc
) \leq \TMap^{\underline{b}, \bar{b}}{\fFunc} +\zeta \Shrinker
\boundFunc$ holds for any $\bar{b}$ with $\bar{b}\leq \MPCmax_{k}$. Let $\fFunc$ be given and let $\gFunc = \fFunc +  \zeta
\boundFunc$. The proof will be more compact if we define
$\bar{\cFunc}$ as the consumption function\footnote{Section~\ref{sec:cExists} proves existence of a
  continuously differentiable consumption function, which implies the
  existence of a corresponding continuously differentiable assets
  function.}  associated with $\TMap^{\underline{b}, \bar{b}} \fFunc$ and $\hat{\cFunc}$ as the consumption functions associated with $\TMap^{\underline{b}, \bar{b}} \gFunc$. Using this notation, condition (3) requires that there exist some $\Shrinker\in (0,1)$ such that for all $ \zeta >0$, we have:
%
%
\begin{align*}
  \uFunc\circ \hat{\cFunc} +\DiscFac \Ex \PermGroFacRnd \gFunc\circ\hat{\mFunc}^{\nxt} & \leq  \uFunc\circ \bar{\cFunc} +\DiscFac \Ex \PermGroFacRnd \fFunc\circ\bar{\mFunc}^{\nxt}  + \zeta \Shrinker \boundFunc.
\end{align*}

where $\bar{\mFunc}^{\nxt}(\mNrm) = \RNrm(\mNrm - \bar{\cFunc}(\mNrm)) + z^{\nxt}$ and $\hat{\mFunc}^{\nxt}(m) = \RNrm(m - \hat{\cFunc}(m)) + z^{\nxt}$. If we now force the consumer facing $\fFunc$ as the next period value function to consume the amount optimal for the consumer facing $\gFunc$, the value for the $\fFunc$ consumer must be weakly lower.  That is,
%
%
%
\begin{align*}
  \uFunc\circ \hat{\cFunc} +\DiscFac \Ex \PermGroFacRnd \fFunc\circ\hat{\mFunc}^{\nxt} & \leq \uFunc(\bar{\cFunc}) + \DiscFac\Ex\PermGroFacRnd \fFunc\circ\bar{\mFunc}^{\nxt}
\end{align*}
%
%
%
Thus, condition (3) will hold if there exists $\alpha$ with $\alpha\in (0,1)$ such that:
%
%
\begin{align*}
  \uFunc\circ \hat{\cFunc} +\DiscFac \Ex\PermGroFacRnd \gFunc \circ \hat{m}^{\nxt}  & \leq  \uFunc\circ \hat{\cFunc} + \DiscFac \Ex \PermGroFac \fFunc\circ\hat{m}^{\nxt}  + \zeta \Shrinker \boundFunc
  \\ \DiscFac\Ex\PermGroFacRnd (\fFunc +\zeta \boundFunc)(\hat{m}^{\nxt})  & \leq  \DiscFac \Ex\PermGroFacRnd \fFunc\circ \hat{m}^{\nxt}  + \zeta \Shrinker \boundFunc
  \\ \DiscFac\zeta \Ex\PermGroFacRnd  \boundFunc\circ\hat{m}^{\nxt}  & \leq  \zeta \Shrinker \boundFunc
  \\ \DiscFac \Ex\PermGroFacRnd \boundFunc \circ \hat{m}^{\nxt}  & \leq  \Shrinker \boundFunc
\end{align*}%\label{eq:reqCondWeak}     

Recall by Claim \ref{claim: MPCMAXKleq1}, we have $\pZero \DiscFac {(\Rfree (1-\MPCmax_{k}))}^{1-\CRRA}   < 1$. As such, use \FVAC~(Equation~\eqref{\localorexternallabel{eq:PFFVAC}}, which says $\DiscFac\Ex\PermGroFac<1$) and fix $\Shrinker$ such that $\Shrinker$ satisfies $\pZero \DiscFac {(\Rfree (1-\MPCmax_{k}))}^{1-\CRRA} < \alpha < 1$ and $\alpha> \beta\Ex\PermGroFacRnd$. Next, use $\boundFunc(\mNrm)= \bar{M} + \mNrm^{1-\CRRA}$ and let $\hat{\aNrm}^{\nxt} = \mNrm - \hat{\cFunc}(\mNrm)$. The condition above will be satisfied if:
%
%
\begin{align*}
  \DiscFac \Ex [{\PermGroFacRnd}^{\nxt}{(\hat{\aNrm}^{\nxt}\RNrm+\tranShkAll)}^{1-\CRRA}]-\Shrinker\mNrm^{1-\CRRA}  & < \alpha\bar{M}(1-\alpha^{-1}\DiscFac\Ex {\PermGroFacRnd})
\end{align*}
%
%
which by the construction of $\Shrinker$ ($\DiscFac\Ex\PermGroFacRnd<\Shrinker$), can be rewritten as:
%
%

\begin{equation}\begin{gathered}\begin{aligned}
      \bar{M}>\frac{\DiscFac \Ex\left[\PermGroFacRnd{(\aNrm^{\nxt}\RNrm^{\nxt} +\tranShkAll_{t+1})}^{1-\CRRA}\right]- \Shrinker\mNrm^{1-\CRRA}}{\Shrinker(1-\alpha^{-1}\DiscFac\Ex {\PermGroFacRnd})}\label{eq:KeyCondition}.
    \end{aligned}\end{gathered}\end{equation}

Since $\bar{M}$ is an arbitrary constant that we can pick, the proof reduces to showing the numerator of~\eqref{\localorexternallabel{eq:KeyCondition}} is bounded from above:
%
%
\begin{equation}
\begin{aligned}
      &\pNotZero\DiscFac\Ex_{t}\left[\PermGroFacRnd{(\hat{\aNrm}^{\nxt}\RNrm^{\nxt}+\tranShkEmp^{\nxt}/\pNotZero)}^{1-\CRRA}\right] \\
      &\quad +\pZero\DiscFac\Ex_{t}\left[\PermGroFacRnd{(\hat{\aNrm}^{\nxt}\RNrm^{\nxt})}^{1-\CRRA}\right]-\Shrinker\mNrm^{1-\CRRA} \\
      &\leq \pNotZero\DiscFac\Ex_{t}\left[\PermGroFacRnd{((1-\MPCmax_{k})\mNrm\RNrm^{\nxt}+\tranShkEmp^{\nxt}/\pNotZero)}^{1-\CRRA}\right] \\
      &\quad +\pZero\DiscFac\Rfree^{1-\CRRA}{((1-\MPCmax_{k})\mNrm)}^{1-\CRRA}- \Shrinker\mNrm^{1-\CRRA} \\
      &= \pNotZero\DiscFac\Ex_{t}\left[\PermGroFacRnd{((1-\MPCmax_{k})\mNrm\RNrm^{\nxt}+\tranShkEmp^{\nxt}/\pNotZero)}^{1-\CRRA}\right] \\
      &\quad +\mNrm^{1-\CRRA}\left(\underbrace{\pZero \DiscFac {(\Rfree (1-\MPCmax_{k}))}^{1-\CRRA}}_{<\Shrinker ~\text{by construction}}-\Shrinker \right) \\
      &< \pNotZero\DiscFac\Ex_{t}\left[\PermGroFacRnd{(\underline{\tranShkEmp}/\pNotZero)}^{1-\CRRA}\right]=\DiscFac\Ex \PermGroFacRnd\pNotZero^{\CRRA}\underline{\tranShkEmp}^{1-\CRRA} .
\end{aligned}
\end{equation}
    
%
%

The first inequality holds since $\bar{b}\leq \MPCmax_{k}$. We can thus conclude that equation~\eqref{\localorexternallabel{eq:KeyCondition}} will certainly hold for any $\bar{M}$ such that:
\begin{equation}\begin{gathered}\begin{aligned}
      \bar{M}>\bar{\bar{M}}\colon =\frac{\DiscFac \Ex \PermGroFacRnd\pNotZero^{\CRRA}\underline{\tranShkEmp}^{1-\CRRA}}{\Shrinker(1- \Shrinker^{-1}\DiscFac \Ex \PermGroFacRnd)}
    \end{aligned}\end{gathered}\end{equation}
    
which is a positive finite number under our assumptions. Noting that with the construction of $\Shrinker$, the above holds for any $\bar{b}\geq \MPCmax_{k}$. Thus $\TMap^{\underline{b}, \bar{b}}$ defines a contraction mapping with modulus $\Shrinker$ for any $\bar{b}$ with  $\bar{b}\geq \MPCmax_{k}$ and $\underline{b}>0$. 
\end{proof}


\begin{proof}[{\textbf{Proof of Theorem \ref{thm:convgtobellman} (Continued)}}]

We continue the proof from the main text below. 

\vspace{0.7em} % Add some space before the heading
\noindent\textit{Proof of (ii)}  % Make it bold and larger
\vspace{0.7em} % Add some space after the heading

Given the proof that the value functions converge, we next establish the point-wise convergence of consumption the functions $\left\{ \cFunc_{t_{n}}\right\}_{n=0}^{\infty}$ along a sub-sequence which will allow us to show that $\vFunc$ satisfies the Bellman operator. Fix any $\mNrm\in S$ and consider a convergent subsequence $\{\cFunc_{t_{n(i)}}(\mNrm)\}_{i=0}^{\infty}$ of $\left\{ \cFunc_{t_{n}}(\mNrm) \right\}_{n=0}^{\infty}$. Let the function $\cFunc$ denote the mapping from $\mNrm$ to the limit of $\{\cFunc_{t_{n(i)}}(\mNrm)\}_{i=0}^{\infty}$. By the definition of $\cFunc_{t_n(i)}(\mNrm)$, we have:

\begin{samepage}
\begin{equation}
\begin{split}
\uFunc(\cFunc_{t_{n(i)}}(\mNrm)) + & \DiscFac \Ex_{t_{n(i)}} \left[ {\PermGroFacRnd}_{t_{n(i)}+1}^{1 - \CRRA} \vFunc_{t_{n(i)+1}}(\mNrm_{t_{n(i)+1}}) \right] \\ 
& \geq \uFunc(\cNrm) + \DiscFac \Ex_{t_{n(i)}} \left[ {\PermGroFacRnd}_{t_{n(i)}+1}^{1 - \CRRA} \vFunc_{t_{n(i)}+1}(\hat{\mNrm}^{\nxt}) \right], 
\end{split}
\end{equation}
\end{samepage}

for any $\cNrm \in (0, \MPCmax \mNrm]$, where $\mNrm_{t_{n(i)}+1} = \RNrm(\mNrm - \cFunc_{t_{n(i)}}(\mNrm)) + \tranShkAll_{t_{n(i)}+1}$ and $\hat{\mNrm}^{\nxt} = \RNrm(\mNrm - \cNrm) + \tranShkAll_{t_{n(i)}+1}$. Allowing $n(i)$ to tend to infinity, the left-hand side converges to:
 
\begin{equation}
\uFunc(\cFunc(m)) + \DiscFac \Ex \left[ {\PermGroFacRnd}^{1 - \CRRA} \vFunc(\mNrm^{\nxt}) \right],
\end{equation}

where $\mNrm^{\nxt} = \RNrm(\mNrm - \cFunc(\mNrm)) + \tranShkAll$. Moreover, the right-hand side converges to:

\begin{equation}
\uFunc(\cNrm) + \DiscFac \Ex \left[ {\PermGroFacRnd}^{1 - \CRRA} \vFunc(\hat{\mNrm}^{\nxt}) \right].
\end{equation}

Hence, as $n(i)$ tends to infinity, the following inequality is implied:
\begin{equation}
\uFunc(\cFunc(\mNrm)) + \DiscFac \Ex \left[ {\PermGroFacRnd}^{1 - \CRRA} \vFunc(\mNrm^{\nxt}) \right] \geq \uFunc(\cNrm) + \DiscFac \Ex \left[ {\PermGroFacRnd}^{1 - \CRRA} \vFunc(\hat{\mNrm}^{\nxt}) \right].
\end{equation}

Since the $\cNrm$ above was arbitrary, we have:
\begin{equation}
\cFunc(\mNrm) \in \underset{\cNrm \in (0, \MPCmax \mNrm]}{\arg \max} \left\{ \uFunc(\cNrm) + \DiscFac \Ex_t \left[ {\PermGroFacRnd}_{t + 1}^{1 - \CRRA} \vFunc(\hat{\mNrm}^{\nxt}) \right] \right\}.
\end{equation}
%By the uniqueness of $\cFunc(\mNrm)$, we determine that $c^* = \cFunc(\mNrm)$.

Next, since $\cFunc_{t_{n(i)}}\rightarrow \cFunc$ point-wise, and $\vFunc_{t_{n(i)}}\rightarrow \vFunc$ point-wise, we have:

\begin{equation}\label{eq:convgcvftni}
\vFunc(\mNrm) = \lim_{i\rightarrow \infty} \uFunc(\cFunc_{t_{n(i)}}(\mNrm)) + \DiscFac\Ex\PermGroFacRnd\vFunc_{t_{n(i)}+1}(\mNrm_{t_{n(i)}+1}) = \uFunc(\cFunc(\mNrm)) + \DiscFac\Ex\PermGroFacRnd\vFunc(\mNrm^{\nxt}). 
\end{equation}

where $\mNrm_{t_{n}} = \RNrm(\mNrm - \cFunc_{t_{n}}(\mNrm)) $ and $\mNrm^{\nxt} = \RNrm(\mNrm - \cFunc(\mNrm))$. The first equality stems form the fact that $\vFunc_{t_{n}}\rightarrow \vFunc$ point-wise, and because point-wise convergence implies point-wise convergence along a sub-sequence. To see why $\lim
\limits_{i\rightarrow \infty} \uFunc(\cFunc_{t_{n(i)}}(\mNrm)) =   \uFunc(\cFunc(\mNrm))$, note the continuity of $\uFunc$ and the convergence of $\cFunc_{t_{n(i)}}$ to $\cFunc$ point-wise. To see why $\lim\limits_{i\rightarrow \infty}\Ex\PermGroFacRnd\vFunc_{t_{n(i)}+1}(\mNrm_{t_{n(i)}+1}) = \Ex\PermGroFacRnd\vFunc(\mNrm^{\nxt})$, note that $\vFunc_{t_{n(i)}+1}$ converges in the $\boundFunc$-norm, hence converges uniformly over compact sets in $S$ and apply Fact \ref{fact:compactnt} from the standard mathematical results presented in Appendix \ref{sec:realanalysis}. This completes the proof of part (ii) of the Theorem. 

\vspace{1em} % Add some space before the heading
\noindent\textit{Proof of (iii)} % Make it bold and larger
\vspace{1em} % Add some space after the heading

The limits at Equation \eqref{eq:convgcvftni} immediately imply:

\begin{equation}
\vFunc(\mNrm) = \lim_{n\rightarrow \infty} \uFunc(\cFunc_{t_{n}}(\mNrm)) + \DiscFac\Ex\PermGroFacRnd\vFunc_{t_{n}+1}(\mNrm_{t_{n}+1}) = \uFunc(\cFunc(\mNrm)) + \DiscFac\Ex\PermGroFacRnd\vFunc(\mNrm^{\nxt}),
\end{equation}

since a real valued sequence can have at most one limit. Finally, applying Fact \ref{fact:xnconvgf} from Appendix \ref{sec:realanalysis}, we get  $\cFunc_{t_{n}}(\mNrm))\rightarrow  \cFunc(\mNrm)$, thus establishing that $\cFunc_{t_{n}}$ converges point-wise to $\cFunc$. 

\end{proof}


\subsection{The Liquidity Constrained Solution as a Limit}\label{sec:LiqConstrAsLimit}


\begin{proof}[\textbf{Proof of Proposition \ref{prop:deatonIsLimit}}]
Formally, suppose we change the description of the problem by making
the following two assumptions:
\begin{eqnarray*}
  \pZero   & = 0
  \\  c_{t} & \leq  \mNrm_{t} \label{eq:liqconstr},
\end{eqnarray*}
and we designate the solution to this consumer's problem $\cnstr{\cFunc}_{t}(\mNrm)$.  We will henceforth refer to this as the problem of the `restrained' consumer (and, to avoid a common confusion, we will refer to the consumer as `constrained' only in circumstances when the constraint is actually binding).

Redesignate the consumption function that emerges from our original problem for a given fixed $\pZero$ as $\cFunc_{t}(\mNrm;\pZero)$ where we separate the arguments by a semicolon to distinguish between $\mNrm$, which is a state variable, and $\pZero$, which is not.  The proposition we wish to demonstrate is
\begin{equation}\begin{gathered}\begin{aligned}
      \lim_{\pZero \downarrow 0} \cFunc_{t}(\mNrm;\pZero)  & = \cnstr{\cFunc}_{t}(\mNrm). \label{eq:RestrEqUnrestr} 
    \end{aligned}\end{gathered}\end{equation}

We will first examine the problem in period $T-1$, then argue that the desired result propagates to earlier periods.  For simplicity, suppose that the interest, growth, and time-preference factors are $\DiscFac = \Rfree = \PermGroFac = 1$, and there are no permanent shocks, $\permShk=1$; the results below are easily generalized to the full-fledged version of the problem.

The solution to the restrained consumer's optimization problem can be obtained as follows.  Assuming that the consumer's behavior in period $T$ is given by $\cFunc_{T}(\mNrm)$ (in practice, this will be $\cFunc_{T}(\mNrm)=m$), consider the unrestrained optimization problem
\begin{equation}\begin{gathered}\begin{aligned}
      \cnstr{\aFunc}^{*}_{T-1}(\mNrm)  & = \underset{\aNrm}{\arg \max} \left\{\uFunc(\mNrm-\aNrm) +  \int_{\underline{\tranShkEmp}}^{\bar{\tranShkEmp}} \vFunc_{T}(a+\tranShkEmp) d\CDF_{\tranShkEmp} \right\}. \label{eq:vUnconstr}
    \end{aligned}\end{gathered}\end{equation}

As usual, the envelope theorem tells us that $\vFunc_{T}^{\prime}(\mNrm)=\uP(\cFunc_{T}(\mNrm))$ so the expected marginal value of ending period $T-1$ with assets $\aNrm$ can be defined as
\begin{equation}\begin{gathered}\begin{aligned}
      \cnstr{\mathfrak{v}}_{T-1}^{\prime}(a)  & \equiv  \int_{\underline{\tranShkEmp}}^{\bar{\tranShkEmp}} \uP(\cFunc_{T}(a+\tranShkEmp)) d\CDF_{\tranShkEmp}, \notag
    \end{aligned}\end{gathered}\end{equation}
and the solution to~\eqref{\localorexternallabel{eq:vUnconstr}} will satisfy
\begin{equation}\begin{gathered}\begin{aligned}
      \uP(\mNrm-\aNrm)  & =  \cnstr{\mathfrak{v}}_{T-1}^{\prime}(a) \label{eq:uPConstr}.
      % 
    \end{aligned}\end{gathered}\end{equation}

$\cnstr{\aFunc}_{T-1}^{*}(\mNrm)$ therefore answers the question ``With what level of assets would the restrained consumer like to end period $T-1$ if the constraint $c_{T-1} \leq \mNrm_{T-1}$ did not exist?''  (Note that the restrained consumer's income process remains different from the process for the unrestrained consumer so long as $\pZero>0$.)  The restrained consumer's actual asset position will be
\begin{equation}\begin{gathered}\begin{aligned}
      \cnstr{\aFunc}_{T-1}(\mNrm)  & = \max[0,\cnstr{\aFunc}^{*}_{T-1}(\mNrm)], \notag
    \end{aligned}\end{gathered}\end{equation}
reflecting the inability of the restrained consumer to spend more than current resources, and note (as pointed out by \cite{deatonLiqConstr}) that
\begin{equation}\begin{gathered}\begin{aligned}
      \mNrm^{1}_{\#}  & = {\left( \cnstr{\mathfrak{v}}_{T-1}^{\prime}(0)\right)}^{-1/\CRRA} \notag
    \end{aligned}\end{gathered}\end{equation}
is the cusp value of $\mNrm$ at which the constraint makes the
transition between binding and non-binding in period $T-1$.

Analogously to~\eqref{\localorexternallabel{eq:uPConstr}}, defining
\begin{equation}\begin{gathered}\begin{aligned}
      \mathfrak{v}_{T-1}^{\prime}(a;\pZero)  & \equiv  \left[\pZero \aNrm^{-\CRRA}+\pNotZero\int_{\underline{\tranShkEmp}}^{\bar{\tranShkEmp}} {\left(\cFunc_{T}(a+\tranShkEmp/\pNotZero)\right)}^{-\CRRA} d\CDF_{\tranShkEmp}\right], \label{eq:vFrakPrime}
    \end{aligned}\end{gathered}\end{equation}
the Euler equation for the original consumer's problem implies
\begin{equation}\begin{gathered}\begin{aligned}
      {(\mNrm-\aNrm)}^{-\CRRA}  & = \mathfrak{v}_{T-1}^{\prime}(a;\pZero) \label{eq:uPUnconstr}
    \end{aligned}\end{gathered}\end{equation}
with solution $\aFunc_{T-1}^{*}(\mNrm;\pZero)$.  Now note that for any fixed $\aNrm>0$, $\lim_{\pZero \downarrow 0} \mathfrak{v}_{T-1}^{\prime}(a;\pZero) = \cnstr{\mathfrak{v}}_{T-1}^{\prime}(a)$.  Since the LHS of~\eqref{\localorexternallabel{eq:uPConstr}} and~\eqref{\localorexternallabel{eq:uPUnconstr}} are identical, this means that $\lim_{\pZero \downarrow 0} \aFunc_{T-1}^{*}(\mNrm;\pZero) = \cnstr{\aFunc}_{T-1}^{*}(\mNrm)$.  That is, for any fixed value of $\mNrm > \mNrm^{1}_{\#}$ such that the consumer subject to the restraint would voluntarily choose to end the period with positive assets, the level of end-of-period assets for the unrestrained consumer approaches the level for the restrained consumer as $\pZero \downarrow 0$.  With the same $\aNrm$ and the same $\mNrm$, the consumers must have the same $c$, so the consumption functions are identical in the limit.

Now consider values $\mNrm\leq \mNrm^{1}_{\#}$ for which the restrained consumer is constrained.  It is obvious that the baseline consumer will never choose $\aNrm \leq 0$ because the first term in~\eqref{\localorexternallabel{eq:vFrakPrime}} is $\lim_{\aNrm \downarrow 0} \pZero \aNrm^{-\CRRA} = \infty$, while $\lim_{\aNrm \downarrow 0} {(\mNrm-\aNrm)}^{-\CRRA}$ is finite (the marginal value of end-of-period assets approaches infinity as assets approach zero, but the marginal utility of consumption has a finite limit for $\mNrm>0$).  The subtler question is whether it is possible to rule out strictly positive $\aNrm$ for the unrestrained consumer.

The answer is yes.  Suppose, for some $\mNrm < \mNrm^{1}_{\#}$, that the unrestrained consumer is considering ending the period with any positive amount of assets $\aNrm=\delta > 0$.  For any such $\delta$ we have that $\lim_{\pZero \downarrow 0} \mathfrak{v}_{T-1}^{\prime}(a;\pZero)=\cnstr{\mathfrak{v}}_{T-1}^{\prime}(a)$.  But by assumption we are considering a set of circumstances in which $\cnstr{\aFunc}_{T-1}^{*}(\mNrm) < 0$, and we showed earlier that $\lim_{\pZero \downarrow 0} \aFunc_{T-1}^{*}(\mNrm;\pZero) = \cnstr{\aFunc}_{T-1}^{*}(\mNrm)$.  So, having assumed $\aNrm = \delta > 0$, we have proven that the consumer would optimally choose $\aNrm < 0$, which is a contradiction.  A similar argument holds for $\mNrm = \mNrm^{1}_{\#}$.

These arguments demonstrate that for any $\mNrm>0$, $\lim_{\pZero \downarrow 0} \cFunc_{T-1}(\mNrm;\pZero) = \cnstr{\cFunc}_{T-1}(\mNrm)$ which is the period $T-1$ version of~\eqref{\localorexternallabel{eq:RestrEqUnrestr}}.  But given equality of the period $T-1$ consumption functions, backwards recursion of the same arguments demonstrates that the limiting consumption functions in previous periods are also identical to the constrained function.

Note finally that another intuitive confirmation of the equivalence between the two problems is that our formula~\eqref{\localorexternallabel{eq:MPCmaxDef}} for the maximal marginal propensity to consume satisfies
\begin{eqnarray*}
  \lim_{\pZero \downarrow 0} \MPCmax  & = 1,
\end{eqnarray*}
which makes sense because the marginal propensity to consume for a constrained restrained consumer is 1 by our definitions of `constrained' and `restrained.'

\end{proof}

\onlyinsubfile{\pagebreak\input{\LaTeXInputs/bibliography_blend}}



\end{document}
\endinput

% Local Variables:
% eval: (setq TeX-command-list  (remove '("Biber" "biber %s" TeX-run-Biber nil  (plain-tex-mode latex-mode doctex-mode ams-tex-mode texinfo-mode)  :help "Run Biber") TeX-command-list))
% eval: (setq TeX-command-list  (remove '("Biber" "biber %s" TeX-run-Biber nil  t  :help "Run Biber") TeX-command-list))
% eval: (setq TeX-command-list  (remove '("BibTeX" "%(bibtex) LaTeX/%s"    TeX-run-BibTeX nil t :help "Run BibTeX") TeX-command-list))
% eval: (setq TeX-command-list  (remove '("BibTeX" "bibtex LaTeX/%s"    TeX-run-BibTeX nil t :help "Run BibTeX") TeX-command-list))
% tex-bibtex-command: "bibtex ../LaTeX/*"
% TeX-PDF-mode: t
% TeX-file-line-error: t
% TeX-debug-warnings: t
% LaTeX-command-style: (("" "%(PDF)%(latex) %(file-line-error) %(extraopts) -output-directory=../LaTeX %S%(PDFout)"))
% TeX-source-correlate-mode: t
% TeX-parse-self: t
% eval: (cond ((string-equal system-type "darwin") (progn (setq TeX-view-program-list '(("Skim" "/Applications/Skim.app/Contents/SharedSupport/displayline -b %n ../LaTeX/%o %b"))))))
% eval: (cond ((string-equal system-type "gnu/linux") (progn (setq TeX-view-program-list '(("Evince" "evince --page-index=%(outpage) ../LaTeX/%o"))))))
% eval: (cond ((string-equal system-type "gnu/linux") (progn (setq TeX-view-program-selection '((output-pdf "Evince"))))))
% TeX-parse-all-errors: t
% End:



\begin{comment}
First we show that $\cFunc_{t}$ is $\mathbf{C}^{1}$.  Define $y$ as $y= m+dm$, where $d>0$.  Noting the definition and properties of $\mathfrak{v}_{t}$ from Equation \eqref{eq:vfFrackdefn}, and since $\uFunc^{\prime }\left( \cFunc_{t}(y)\right) -\uFunc^{\prime }\left(
  \cFunc_{t}(\mNrm)\right) =\mathfrak{v}_{t}^{\prime
}({\aFunc}_{t}(y))-\mathfrak{v}_{t}^{\prime }({\aFunc}_{t}(\mNrm))$ by Equation \eqref{eq:consumptionf} and $
\frac{{\aFunc}_{t}(y)-{\aFunc}_{t}(\mNrm)}{dm}=1-\frac{\cFunc_{t}(y)-\cFunc_{t}(\mNrm)}{dm}$, we have:
%
\begin{multline*}
  % \lefteqn{
  \frac{\mathfrak{v}_{t}^{\prime }({\aFunc}_{t}(y))-\mathfrak{v}_{t}^{\prime }({\aFunc}_{t}(\mNrm))}{{\aFunc}_{t}(y)-{\aFunc}_{t}(\mNrm)} %  }
  \\ =   
    \left( \frac{\uFunc^{\prime }\left( \cFunc_{t}(y)\right) -\uFunc^{\prime }\left( \cFunc_{t}(\mNrm)\right) }{\cFunc_{t}(y)-\cFunc_{t}(\mNrm)}+\frac{\mathfrak{v}_{t}^{\prime }({\aFunc}_{t}(y))-\mathfrak{v}_{t}^{\prime }({\aFunc}_{t}(\mNrm))}{{\aFunc}_{t}(y)-{\aFunc}_{t}(\mNrm)}\right) \frac{\cFunc_{t}(y)-\cFunc_{t}(\mNrm)}{dm}.
\end{multline*}

%
Next, since $\cFunc_{t}$ and $\aFunc_{t}$ are continuous and increasing, $\underset{
  dm\rightarrow +0}{\lim }\frac{\uFunc^{\prime }\left( \cFunc_{t}(y)\right) -\uFunc^{\prime
  }\left( \cFunc_{t}(\mNrm)\right) }{\cFunc_{t}(y)-\cFunc_{t}(\mNrm)}<0$ and we have
$\underset{dm\rightarrow+0}{\lim }\frac{\mathfrak{v}_{t}^{\prime }({\aFunc}_{t}(y))-\mathfrak{v}_{t}^{\prime }({\aFunc}_{t}(\mNrm))}{
  {\aFunc}_{t}(y)-{\aFunc}_{t}(\mNrm)}< 0$
are satisfied. Then $\frac{\uFunc^{\prime }\left(
    \cFunc_{t}(y)\right) -\uFunc^{\prime }\left( \cFunc_{t}(\mNrm)\right) }{\cFunc_{t}(y)-\cFunc_{t}(\mNrm)}+
\frac{\mathfrak{v}_{t}^{\prime }({\aFunc}_{t}(y))-\mathfrak{v}_{t}^{\prime }({\aFunc}_{t}(\mNrm))}{{\aFunc}_{t}(y)-{\aFunc}_{t}(\mNrm)}
<0$ for sufficiently small $dm$.
Hence we obtain:

\begin{equation*}
  \frac{\cFunc_{t}(y)-\cFunc_{t}(\mNrm)}{dm}=\frac{\frac{\mathfrak{v}_{t}^{\prime
      }({\aFunc}_{t}(y))-\mathfrak{v}_{t}^{\prime }({\aFunc}_{t}(\mNrm))}{{\aFunc}_{t}(y)-{\aFunc}_{t}(\mNrm)}}{\frac{\uFunc^{\prime
      }\left( \cFunc_{t}(y)\right) -\uFunc^{\prime }\left( \cFunc_{t}(\mNrm)\right) }{
      \cFunc_{t}(y)-\cFunc_{t}(\mNrm)}+\frac{\mathfrak{v}_{t}^{\prime }({\aFunc}_{t}(y))-\mathfrak{v}_{t}^{\prime }({\aFunc}_{t}(\mNrm))
    }{{\aFunc}_{t}(y)-{\aFunc}_{t}(\mNrm)}}.
\end{equation*}
This implies that the right-derivative, $\cFunc_{t}^{\prime +}(\mNrm)$ is
well-defined and we have:
%
\begin{equation*}
  \cFunc_{t}^{\prime +}(\mNrm)=\frac{\mathfrak{v}_{t}^{\prime \prime }({\aFunc}_{t}(\mNrm))}{\uFunc^{\prime \prime
    }(\cFunc_{t}(\mNrm))+\mathfrak{v}_{t}^{\prime \prime }({\aFunc}_{t}(\mNrm))}.
\end{equation*}

Similarly we can show that $\cFunc_{t}^{\prime +}(\mNrm)=\cFunc_{t}^{\prime -}(\mNrm)$,
which means $\cFunc_{t}^{\prime }(\mNrm)$ exists for any $m\in S$. Since $\mathfrak{v}_{t}$ is
$\mathbf{C}^{3}$, $ \cFunc_{t}^{\prime }(\mNrm)$ exists and is continuous.
Thus $\cFunc_{t}^{\prime }(\mNrm)$ is differentiable because
$\mathfrak{v}_{t}^{\prime \prime }$ is $\mathbf{C}^{1}$, $ \cFunc_{t}(\mNrm)$
is $\mathbf{C}^{1}$ and $\uFunc^{\prime \prime
}(\cFunc_{t}(\mNrm))+\mathfrak{v}_{t}^{\prime \prime }\left( {\aFunc}_{t}(\mNrm)\right)
<0$. $\cFunc_{t}^{\prime \prime }(\mNrm)$ is given by:
\begin{equation}
  \cFunc_{t}^{\prime \prime }(\mNrm)=\frac{{\aNrm}_{t}^{\prime }(\mNrm)\mathfrak{v}_{t}^{\prime \prime
      \prime }({\aNrm}_{t})\left[ \uFunc^{\prime \prime }(c_{t})+\mathfrak{v}_{t}^{\prime \prime }({\aNrm}_{t})
    \right] -\mathfrak{v}_{t}^{\prime \prime }({\aNrm}_{t})\left[ c_{t}^{\prime }\uFunc^{\prime \prime
        \prime }(c_{t})+{\aNrm}_{t}^{\prime }\mathfrak{v}_{t}^{\prime \prime \prime }({\aNrm}_{t})\right] }{
    {\left[ \uFunc^{\prime \prime }(c_{t})+\mathfrak{v}_{t}^{\prime \prime }({\aNrm}_{t})\right]}^{2}}.
\end{equation}
Since $\mathfrak{v}_{t}^{\prime \prime }({\aFunc}_{t}(\mNrm))$ is continuous,
$\cFunc_{t}^{\prime \prime }(\mNrm)$ is also continuous.
\end{proof}
\end{comment}
